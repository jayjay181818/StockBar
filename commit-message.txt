refactor: improve code quality and stability

- Remove force unwrapping and improve error handling
- Add better type safety with TradingData struct
- Fix parameter naming inconsistencies
- Improve code organization and modularity
- Add proper documentation and MARK comments
- Fix memory management issues
- Improve currency formatting
- Remove unnecessary dependencies

This commit improves the overall stability and maintainability of the codebase while fixing several potential crash points and memory leaks. The changes focus on making the code more type-safe and easier to maintain.